<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  <mapper namespace="green.mapper.MovieMapper">
  		
 	
  		<!-- ** totalRowCount ** -->
  		<select id="totalRowCount" resultType="int">
  			select count(*) from movie
  		</select>	
  		
  		<!-- ** PageList ** -->
  		<select id="pageList" resultType="VO.MovieVO">
  		select movie_num,movie_title,director,release, posterfile,trailer 
  		from(select m.*,row_number() over(order by release)
  		 rnum from movie m) where rnum between #{sno} and #{eno}
  		 
  		</select>
  		
  		<select id="selectList" resultType="VO.MovieVO">
  		
  			select * from movie order by release
  		</select>
  		
  		 <select id="selectOne" resultType="VO.MovieVO">
  		
  		<!-- #은 파라미터로 흘러들어오는 값 -->
  			select * from movie where movie_num = #{movie_num} 
  		</select>  	
  			
  		<insert id="insert" >
  		
  			insert into movie values(
  			(select nvl(max(movie_num),0)+1 from movie),
  			#{movie_title},#{director},#{release},#{posterfile},#{trailer})
  
  		</insert>  		
  		
		<update id="update">
			update movie set movie_title=#{movie_title}, director=#{director},
			release=#{release}, posterfile=#{posterfile}, trailer=#{trailer}
			 where movie_num=#{movie_num}
		</update>
		
		<delete id="delete">
			delete from movie where movie_num=#{movie_num}
		</delete>
  </mapper>